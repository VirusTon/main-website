<!DOCTYPE html>  
<html lang="ar">  
<head>  
  <meta charset="UTF-8" />  
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>  
  <title>نقطة بلس | تسجيل الدخول</title>  
  <style>  
    body {  
      direction: rtl;  
      font-family: Arial, sans-serif;  
      background: #f7f7f7;  
      display: flex;  
      justify-content: center;  
      align-items: center;  
      height: 100vh;  
    }  
    .container {  
      background: white;  
      padding: 2rem;  
      border-radius: 16px;  
      box-shadow: 0 0 10px rgba(0,0,0,0.1);  
      width: 90%;  
      max-width: 400px;  
    }  
    input, button {  
      width: 80%;  
      padding: 1rem;  
      margin: 0.5rem 0;  
      font-size: 1rem;  
      border-radius: 8px;  
      border: 1px solid #ccc;  
    }  
    button {  
      background-color: #007bff;  
      color: white;  
      border: none;
      width: 40%;
    }  
    #status {  
      margin-top: 1rem;  
      color: green;  
    }  
  </style>  
</head>  
<body>
  
  <div class="container">  
    <h2>تسجيل الدخول / إنشاء حساب</h2>  
    <input type="text" id="userId" placeholder="معرّف المستخدم (ID)">  
    <input type="password" id="password" placeholder="كلمة المرور">  
    <button onclick="loginOrRegister()">دخول</button>  
    <div id="status"></div>

    <!-- إعلان -->
  <div style="text-align:center; margin: 10px 0;">
    <script type="text/javascript">
      atOptions = {
        'key' : '637282bc26477d3191a82e2037188c44',
        'format' : 'iframe',
        'height' : 50,
        'width' : 320,
        'params' : {}
      };
    </script>
    <script type="text/javascript" src="//www.highperformanceformat.com/637282bc26477d3191a82e2037188c44/invoke.js"></script>
  </div> <!-- نهاية الإعلان هنا -->
    
  </div>  
  
  <script>  
    const scriptURL = 'https://script.google.com/macros/s/AKfycbwsfve3uGNbKhZM15VdakGcbmMLwOyZ3CrUQ3aKpzRjM_FRFVfb9NbPrR524dpITBhN/exec';  
  
    async function loginOrRegister() {  
      const userId = document.getElementById('userId').value.trim();  
      const password = document.getElementById('password').value.trim();  
      const status = document.getElementById('status');  
  
      if (!userId || !password) {  
        status.style.color = 'red';  
        status.innerText = 'يرجى إدخال معرف وكلمة مرور.';  
        return;  
      }  
  
      status.innerText = '...جارٍ التحقق';  
  
      const params = new URLSearchParams();  
      params.append("action", "loginOrRegister");  
      params.append("id", userId);  
      params.append("password", password);  
  
      try {  
        const res = await fetch(`${scriptURL}?${params.toString()}`);  
        const result = await res.json();  
  
        if (result.status === "login_success") {  
          status.style.color = 'green';  
          status.innerText = 'تم تسجيل الدخول بنجاح ✅';  
          // تخزين الجلسة مؤقتًا  
          localStorage.setItem("userId", userId);  
          localStorage.setItem("password", password);  
          // الانتقال للواجهة التالية  
          setTimeout(() => {  
            window.location.href = "dashboard.html";  
          }, 1000);  
        } else if (result.status === "register_success") {  
          status.style.color = 'blue';  
          status.innerText = 'تم إنشاء الحساب بنجاح 🎉';  
          localStorage.setItem("userId", userId);  
          localStorage.setItem("password", password);  
          setTimeout(() => {  
            window.location.href = "dashboard.html";  
          }, 1000);  
        } else {  
          status.style.color = 'red';  
          status.innerText = 'كلمة المرور غير صحيحة ❌';  
        }  
      } catch (e) {  
        status.style.color = 'red';  
        status.innerText = 'حدث خطأ في الاتصال.';  
      }  
    }  
  </script>  
</body>  
</html>
